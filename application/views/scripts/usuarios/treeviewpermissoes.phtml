   <?php    $result=$this->permissoes;
            $nomeprojetos=$this->nomeprojetos;

   ?>

<script type="text/javascript">

    $(document).ready(function() {
        load();    // put all your jQuery goodness in here.
        // carrega ao inicio
    });

    function load()
    {
        var arreglo = new Array();
        var arreglo_valor=new Array();
        var arreglo_nome = new Array();
        var i=0;
        var k=0;
        <?php

        // for para preencher as permissoes no arreglo javascript arreglo[i]
        $nro=count($result);
        for($i=0;$i<$nro;$i++)
        {
               ?>
             arreglo[i]= "<?php echo $result[$i]; ?>";
             i++; <?php }


        if(count($nomeprojetos)!=0)
        {
            // for para preencher os nomes do projeto e seu valor no arreglo javascript arreglonomes[i]
            for($i=0;$i<count($nomeprojetos);$i++)
            {
                ?>
                arreglo_valor[k]= "<?php echo $nomeprojetos[$i]['valor']; ?>";
                arreglo_nome[k]= "<?php echo $nomeprojetos[$i]['nome']; ?>";
                k++; <?php }?>

            for(i=0;i<arreglo_nome.length;i++)
            {
                agregar(arreglo_valor[i],arreglo_nome[i]);
            }
        <?php }?>



        var frm = document.getElementById("formu");
        var pat = /detalhes/;
        for(i=0;i< arreglo.length; i++)
        {
             for (j=0;j<frm.elements.length;j++)
             {
                 if(frm.elements[j].type=='checkbox')
                 {
                     if(frm.elements[j].value == arreglo[i])
                       frm.elements[j].checked=true;


                 }
            }
        }
    }

    $(document).ready(function() {
        $('.fancybox').fancybox();
        $("#pesquisarprojetos").click(function() {
            $('<a class="fancybox fancybox.iframe" href="usuarios/fancyboxprojetos">pesquisar</a>').fancybox({
                overlayShow: true
            }).click();
        });
    });

    function agregar($id,$nome){

        var ProAl="proAl";
        var branches = $("<li><input id='" + $id + "' name='datostree[]' type='checkbox' value='projetos|index|" + $id + "' checked >" + $nome + " <button type='button' onclick='apagar(" + $id + ")'>apagar</button><ul>" +
                "<li><input name='datostree[]' type='checkbox' id='"+$id+"Vi' onclick=habilitar('"+$id+"Vi','"+$id+"Al') value='projetos|detalhes|"+$id+"' >Visualizar</li>" +
                "<li><input name='datostree[]' type='checkbox' id='proAd' value='projetos|adicionar|*'  >Adicionar</li>" +
                "<li><input name='datostree[]' type='checkbox' id='"+$id+"Al' value='projetos|adicionar|"+$id+"' disabled='true'>Alterar</li>" +
                "<li><input name='datostree[]' type='checkbox' id='proAp' value='projetos|excluir|"+$id+"' >Apagar</li></ul></li>").appendTo("#proj");
        $("#browser").treeview({
            add: branches
        });
    }

    function apagar($id){
        if ($("#"+$id+"").is("li") || $("#"+$id+"").parents("li").length) {
            $("#browser").treeview({
                remove: $("#"+$id+"").parents("li").filter(":first")
            });
            return false;
        }
    }

    $(function() {
        $("#browser").treeview();
        $("#browser1").treeview();
        $("#browser2").treeview();
        $("#browser3").treeview();
    })

    function habilitar($id_check, $id_disabled)
    {
        if(document.getElementById($id_check).checked==true)
            document.getElementById($id_disabled).disabled=false;
        else
        {
            document.getElementById($id_disabled).disabled=true;
            document.getElementById($id_disabled).checked=false;
        }
    }

</script>

<form name="formu" id="formu" action="<?php echo $this->url()?>" method="post">

    <div id="main">
        <ul id="browser" class="filetree">
            <li id="proj"><input name="datostree[]" type="checkbox" id="proAc" value="projetos|index|*">Projetos <button id="pesquisarprojetos" type="button">Adicionar</button></li>
        </ul>
    </div>

    <div id="main1">
        <ul id="browser1" class="filetree">

            <li><input name="datostree[]" type="checkbox" id="tarAc" value="tarefas|index|*">Tarefas
                <ul id="tarefas">
                    <li><input name="datostree[]" type="checkbox" id="tarVi" value="tarefas|detalhes|*"  onclick='habilitar("tarVi","tarAl")'>Visualizar</li>
                    <li><input name="datostree[]" type="checkbox" id="tarAd" value="tarefas|adicionar|*" >Adicionar</li>
                    <li><input name="datostree[]" type="checkbox" id="tarAl" value="tarefas|adicionar|#" disabled="true">Alterar</li>
                    <li><input name="datostree[]" type="checkbox" id="tarAp" value="tarefas|excluir|*">Apagar</li>
                </ul>
            </li>

            <li><input  name="datostree[]" type="checkbox" id="arqAc" value="arquivos|index|*">Arquivos
                <ul id="arquivos">
                    <li><input name="datostree[]" type="checkbox" id="arqVi" value="arquivos|detalhes|*" onclick='habilitar("arqVi","arqAl")'>Visualizar</li>
                    <li><input name="datostree[]" type="checkbox" id="arqAd" value="arquivos|adicionar|*" >Adicionar</li>
                    <li><input name="datostree[]" type="checkbox" id="arqAl" value="arquivos|adicionar|#" disabled="true">Alterar</li>
                    <li><input name="datostree[]" type="checkbox" id="arqAp" value="arquivos|excluir|*" >Apagar</li>
                </ul>
            </li>
            <li><input  name="datostree[]" type="checkbox" id="benAc" value="beneficiarios|index|*">Beneficiario
                <ul id="beneficiarios">
                    <li><input name="datostree[]" type="checkbox" id="benVi" value="beneficiarios|detalhes|*" onclick='habilitar("benVi","benAl")'>Visualizar</li>
                    <li><input name="datostree[]" type="checkbox" id="benAd" value="beneficiarios|adicionar|*" >Adicionar</li>
                    <li><input name="datostree[]" type="checkbox" id="benAl" value="beneficiarios|adicionar|#" disabled="true">Alterar</li>
                    <li><input name="datostree[]" type="checkbox" id="benAp" value="beneficiarios|excluir|*" >Apagar</li>
                </ul>
            </li>
        </ul>
    </div>

    <div id="main2">
        <ul id="browser2" class="filetree">
            <li><input  name="datostree[]" type="checkbox" id="usuAc" value="usuarios|index|*">Usuario
                <ul id="usuarios">
                    <li><input name="datostree[]" type="checkbox" id="usuVi" value="usuarios|detalhes|*" onclick='habilitar("usuVi","usuAl")'>Visualizar</li>
                    <li><input name="datostree[]" type="checkbox" id="usuAd" value="usuarios|adicionar|*" >Adicionar</li>
                    <li><input name="datostree[]" type="checkbox" id="usuAl" value="usuarios|adicionar|#" disabled="true">Alterar</li>
                    <li><input name="datostree[]" type="checkbox" id="usuAp" value="usuarios|excluir|*" >Apagar</li>
                </ul>
            </li>
            <li><input  name="datostree[]" type="checkbox" id="empAc" value="empenhos|index|*">Empenho
                <ul id="empenhos">
                    <li><input name="datostree[]" type="checkbox" id="empVi" value="empenhos|detalhes|*" onclick='habilitar("empVi","empAl")'>Visualizar</li>
                    <li><input name="datostree[]" type="checkbox" id="empAd" value="empenhos|adicionar|*" >Adicionar</li>
                    <li><input name="datostree[]" type="checkbox" id="empAl" value="empenhos|adicionar|#" disabled="true">Alterar</li>
                    <li><input name="datostree[]" type="checkbox" id="empAp" value="empenhos|excluir|*" >Apagar</li>
                </ul>
            </li>
            <li><input  name="datostree[]" type="checkbox" id="insAc" value="instituicoes|index|*">Instituições
                <ul id="instituicoes">
                    <li><input name="datostree[]" type="checkbox" id="insVi" value="instituicoes|detalhes|*" onclick='habilitar("insVi","insAl")'>Visualizar</li>
                    <li><input name="datostree[]" type="checkbox" id="insAd" value="instituicoes|adicionar|*" >Adicionar</li>
                    <li><input name="datostree[]" type="checkbox" id="insAl" value="instituicoes|adicionar|#" disabled="true">Alterar</li>
                    <li><input name="datostree[]" type="checkbox" id="insAp" value="instituicoes|excluir|*" >Apagar</li>
                </ul>
            </li>
        </ul>
    </div>

    <div id="main3">
        <ul id="browser3" class="filetree">
            <li><input  name="datostree[]" type="checkbox" id="orcAc" value="orcamentario|index|*">Orçamento
                <ul id="orcamentario">
                    <li><input name="datostree[]" type="checkbox" id="orcVi" value="orcamentario|detalhes|*" onclick='habilitar("orcVi","orcAl")'>Visualizar</li>
                    <li><input name="datostree[]" type="checkbox" id="orcAd" value="orcamentario|adicionar|*" >Adicionar</li>
                    <li><input name="datostree[]" type="checkbox" id="orcAl" value="orcamentario|adicionar|#" disabled="true">Alterar</li>
                    <li><input name="datostree[]" type="checkbox" id="orcAp" value="orcamentario|excluir|*" >Apagar</li>
                </ul>
            </li>
            <li><input  name="datostree[]" type="checkbox" id="solAc" value="solicitacoes|index|*">Solicitações
                <ul id="solicitacoes">
                    <li><input name="datostree[]" type="checkbox" id="solVi" value="solicitacoes|detalhes|*" onclick='habilitar("solVi","solAl")'>Visualizar</li>
                    <li><input name="datostree[]" type="checkbox" id="solAd" value="solicitacoes|adicionar|*" >Adicionar</li>
                    <li><input name="datostree[]" type="checkbox" id="solAl" value="solicitacoes|adicionar|#" disabled="true">Alterar</li>
                    <li><input name="datostree[]" type="checkbox" id="solAp" value="solicitacoes|excluir|*" >Apagar</li>
                </ul>
            </li>
            <li><input  name="datostree[]" type="checkbox" id="tadAc" value="termoaditivo|index|*">Termo Aditivo
                <ul id="termoaditivo">
                    <li><input name="datostree[]" type="checkbox" id="tadVi" value="termoaditivo|detalhes|*" onclick='habilitar("tadVi","tadAl")'>Visualizar</li>
                    <li><input name="datostree[]" type="checkbox" id="tadAd" value="termoaditivo|adicionar|*" >Adicionar</li>
                    <li><input name="datostree[]" type="checkbox" id="tadAl" value="termoaditivo|adicionar|#" disabled="true">Alterar</li>
                    <li><input name="datostree[]" type="checkbox" id="tadAp" value="termoaditivo|excluir|*" >Apagar</li>
                </ul>
            </li>
        </ul>
    </div>
    <div id="but">

        <input type="submit" value="Submit">
    </div>
</form>





